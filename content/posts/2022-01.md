---
title: "January, 2022"
date: 2022-01-01T15:20:54+02:00
author: "Alan Orth"
categories: ["Notes"]
---

## 2022-01-01

- Start a full harvest on AReS

<!--more-->

## 2022-01-06

- Add ORCID identifier for Chris Jones to CGSpace
  - Also tag eighty-eight of his items in CGSpace:

```console
$ cat 2022-01-06-add-orcids.csv 
dc.contributor.author,cg.creator.identifier
"Jones, Chris","Chris Jones: 0000-0001-9096-9728"
"Jones, Christopher S.","Chris Jones: 0000-0001-9096-9728"
$ ./ilri/add-orcid-identifiers-csv.py -i 2022-01-06-add-orcids.csv -db dspace63 -u dspacetest -p 'dom@in34sniper' 
```

## 2022-01-09

- Validate and register CGSpace on [OpenArchives](https://www.openarchives.org/Register/ValidateSite?log=Z2V7WCT7)
  - Last month IWMI colleagues were asking me to look into this, and after checking the OpenArchives mailing list it seems there was a problem on the server side
  - Now it has worked and the message is "Successfully updated OAI registration database to status COMPLIANT."
  - I received an email (as the Admin contact on our OAI) that says:

> Your repository has been registered in the OAI database of conforming repositories.

- Now I'm taking a screenshot of the validation page for posterity, because the logs seem to go away after some time

![OpenArchives.org registration](/cgspace-notes/2022/01/openarchives-registration.png)

- I tried to re-build the Docker image for OpenRXV and got an error in the backend:

```console
...
> openrxv-backend@0.0.1 build
> nest build

node_modules/@elastic/elasticsearch/api/types.d.ts:2454:13 - error TS2456: Type alias 'AggregationsAggregate' circularly references itself.

2454 export type AggregationsAggregate = AggregationsSingleBucketAggregate | AggregationsAutoDateHistogramAggregate | AggregationsFiltersAggregate | AggregationsSignificantTermsAggregate<any> | AggregationsTermsAggregate<any> | AggregationsBucketAggregate | AggregationsCompositeBucketAggregate | AggregationsMultiBucketAggregate<AggregationsBucket> | AggregationsMatrixStatsAggregate | AggregationsKeyedValueAggregate | AggregationsMetricAggregate
                 ~~~~~~~~~~~~~~~~~~~~~
node_modules/@elastic/elasticsearch/api/types.d.ts:3209:13 - error TS2456: Type alias 'AggregationsSingleBucketAggregate' circularly references itself.

3209 export type AggregationsSingleBucketAggregate = AggregationsSingleBucketAggregateKeys
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Found 2 error(s).
```

- Ah, it seems the code on the server was slightly out of date
  - I checked out the latest master branch and it built

## 2022-01-12

- Fix some citation formatting issues in Gaia's [eighteen CAS Green Cover publications on DSpace Test](https://dspacetest.cgiar.org/handle/10568/115230)

## 2022-01-19

- Francesca was having issues with a submission on CGSpace this week
  - I checked and see a lot of locks in PostgreSQL:

```console
$ psql -c "SELECT application_name FROM pg_locks pl LEFT JOIN pg_stat_activity psa ON pl.pid = psa.pid" | sort | uniq -c | sort -n
      1 
      1 ------------------
      1 (3506 rows)
      1  application_name 
      9  psql
     10  
   3487  dspaceWeb
```

- As before, I see messages from PostgreSQL about processes waiting for locks since I enabled the `log_lock_waits` setting last month:

```console
$ grep -E '^2022-01*' /var/log/postgresql/postgresql-10-main.log | grep -c 'still waiting for'
12
```

- I set a system alert on DSpace and then restarted the server

<!-- vim: set sw=2 ts=2: -->
