---
title: "March, 2019"
date: 2019-03-01T12:16:30+01:00
author: "Alan Orth"
tags: ["Notes"]
---

## 2019-03-01

- I checked IITA's 259 Feb 14 records from last month for duplicates using Atmire's Duplicate Checker on a fresh snapshot of CGSpace on my local machine and everything looks good
- I am now only waiting to hear from her about where the items should go, though I assume Journal Articles go to IITA Journal Articles collection, etc...
- Looking at the other half of Udana's WLE records from 2018-11
  - I finished the ones for Restoring Degraded Landscapes (RDL), but these are for Variability, Risks and Competing Uses (VRC)
  - I did the usual cleanups for whitespace, added regions where they made sense for certain countries, cleaned up the DOI link formats, added rights information based on the publications page for a few items
  - Most worryingly, there are encoding errors in the abstracts for eleven items, for example:
  - 68.15% � 9.45 instead of 68.15% ± 9.45
  - 2003�2013 instead of 2003–2013
- I think I will need to ask Udana to re-copy and paste the abstracts with more care using Google Docs

<!--more-->

## 2019-03-03

- Trying to finally upload IITA's 259 Feb 14 items to CGSpace so I exported them from DSpace Test:

```
$ mkdir 2019-03-03-IITA-Feb14
$ dspace export -i 10568/108684 -t COLLECTION -m -n 0 -d 2019-03-03-IITA-Feb14
```

- As I was inspecting the archive I noticed that there were some problems with the bitsreams:
  - First, Sisay didn't include the bitstream descriptions
  - Second, only five items had bitstreams and I remember in the discussion with IITA that there should have been nine!
  - I had to refer to the original CSV from January to find the file names, then download and add them to the export contents manually!
- After adding the missing bitstreams and descriptions manually I tested them again locally, then imported them to a temporary collection on CGSpace:

```
$ dspace import -a -c 10568/99832 -e aorth@stfu.com -m 2019-03-03-IITA-Feb14.map -s /tmp/2019-03-03-IITA-Feb14
```

- DSpace's export function doesn't include the collections for some reason, so you need to import them somewhere first, then export the collection metadata and re-map the items to proper owning collections based on their types using OpenRefine or something
- After re-importing to CGSpace to apply the mappings, I deleted the collection on DSpace Test and ran the `dspace cleanup` script
- Merge the IITA research theme changes from last month to the `5_x-prod` branch ([#413](https://github.com/ilri/DSpace/pull/413))
  - I will deploy to CGSpace soon and then think about how to batch tag all IITA's existing items with this metadata
- Deploy Tomcat 7.0.93 on CGSpace (linode18) after having tested it on DSpace Test (linode19) for a week

## 2019-03-06

- Abenet was having problems with a CIP user account, I think that the user could not register
- I suspect it's related to the email issue that ICT hasn't responded about since last week
- As I thought, I still cannot send emails from CGSpace:

```
$ dspace test-email

About to send test email:
 - To: blah@stfu.com
 - Subject: DSpace test email
 - Server: smtp.office365.com

Error sending email:
 - Error: javax.mail.AuthenticationFailedException
```

- I will send a follow-up to ICT to ask them to reset the password

## 2019-03-07

- ICT reset the email password and I confirmed that it is working now
- Generate a controlled vocabulary of 1187 AGROVOC subjects from the top 1500 that I checked last month, dumping the terms themselves using `csvcut` and then applying XML controlled vocabulary format in vim and then checking with tidy for good measure:

```
$ csvcut -c name 2019-02-22-subjects.csv > dspace/config/controlled-vocabularies/dc-contributor-author.xml
$ # apply formatting in XML file
$ tidy -xml -utf8 -iq -m -w 0 dspace/config/controlled-vocabularies/dc-subject.xml
```

- I tested the AGROVOC controlled vocabulary locally and will deploy it on DSpace Test soon so people can see it
- Atmire noticed my message about the "solr_update_time_stamp" error on the dspace-tech mailing list and created an issue on their tracker to discuss it with me
  - They say the error is harmless, but has nevertheless been fixed in their newer module versions

## 2019-03-08

- There's an issue with CGSpace right now where all items are giving a blank page in the XMLUI
  - Interestingly, if I check an item in the REST API it is also mostly blank: only the title and the ID!
  - I don't see anything unusual in the Tomcat logs, though there are thousands of those `solr_update_time_stamp` errors:

```
# journalctl -u tomcat7 | grep -c 'Multiple update components target the same field:solr_update_time_stamp'
1076
```

- I restarted Tomcat and it's OK now...
- Skype meeting with Peter and Abenet and Sisay
  - We want to try to crowd source the correction of invalid AGROVOC terms starting with the ~313 invalid ones from our top 1500
  - We will share a Google Docs spreadsheet with the partners and ask them to mark the deletions and corrections
  - Abenet and Alan to spend some time identifying correct DCTERMS fields to move to, with preference over CG Core 2.0 as we want to be globally compliant (use information from SEO crosswalks)
  - I need to follow up on the privacy page that Sisay worked on
  - We want to try to migrate the 600 [Livestock CRP blog posts](https://livestock.cgiar.org) to CGSpace, Peter will try to export the XML from WordPress so I can try to parse it with a script

## 2019-03-09

- I shared a post on Yammer informing our editors to try to AGROVOC controlled list
- The SPDX legal committee had a meeting and discussed the addition of CC-BY-ND-3.0-IGO and other IGO licenses to their list, but it seems unlikely ([spdx/license-list-XML/issues/767](https://github.com/spdx/license-list-XML/issues/767#issuecomment-470709673))
- The FireOak report highlights the fact that several CGSpace collections have mixed-content errors due to the use of HTTP links in the Feedburner forms
- I see 46 occurrences of these with this query:

```
dspace=# SELECT text_value FROM metadatavalue WHERE resource_type_id in (3,4) AND (text_value LIKE '%http://feedburner.%' OR text_value LIKE '%http://feeds.feedburner.%');
```

- I can replace these globally using the following SQL:

```
dspace=# UPDATE metadatavalue SET text_value = REGEXP_REPLACE(text_value, 'http://feedburner.','https//feedburner.', 'g') WHERE resource_type_id in (3,4) AND text_value LIKE '%http://feedburner.%';
UPDATE 43
dspace=# UPDATE metadatavalue SET text_value = REGEXP_REPLACE(text_value, 'http://feeds.feedburner.','https//feeds.feedburner.', 'g') WHERE resource_type_id in (3,4) AND text_value LIKE '%http://feeds.feedburner.%';
UPDATE 44
```

- I ran the corrections on CGSpace and DSpace Test


<!-- vim: set sw=2 ts=2: -->
